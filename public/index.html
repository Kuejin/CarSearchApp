<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Car Search</title>
  <style>
    body {
      margin: 0;
      font-family: sans-serif;
      background-color: #4a7da0;
      color: white;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 20px;
    }

    .tabs {
      display: flex;
      justify-content: center;
      margin-bottom: 20px;
      gap: 10px;
    }

    .tab-button {
      padding: 10px 20px;
      font-size: 16px;
      border: none;
      background-color: #2e5b7f;
      color: white;
      border-radius: 5px;
      cursor: pointer;
    }

    .tab-button.active {
      background-color: #16364d;
      font-weight: bold;
    }

    .section {
      display: none;
      width: 100%;
      max-width: 550px;
      background-color: rgba(255, 255, 255, 0.1);
      padding: 20px;
      border-radius: 10px;
      margin-bottom: 40px;
    }

    .section.active {
      display: block;
    }

    h1, h2 {
      font-size: 28px;
      margin-top: 0;
      margin-bottom: 20px;
      color: white;
      text-align: center;
      border-bottom: 2px solid white;
      padding-bottom: 10px;
    }

    input {
      display: block;
      width: 100%;
      margin-bottom: 10px;
      padding: 10px;
      font-size: 16px;
      border: none;
      border-radius: 5px;
    }

    /* 차 번호 입력만 높이 2배 */
    #car_number,
    #add_car_number {
      padding: 20px;
      font-weight: bold;
    }

    button {
      padding: 10px 20px;
      font-size: 16px;
      background-color: #2e5b7f;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }

    button:hover {
      background-color: #244d6c;
    }

    #result {
      margin-top: 20px;
      max-width: 550px;
      width: 100%;
      background-color: rgba(0, 0, 0, 0.2);
      padding: 15px;
      border-radius: 10px;
    }

    .result-item {
      margin-bottom: 15px;
      border-bottom: 1px solid rgba(255,255,255,0.3);
      padding-bottom: 10px;
    }

    .top-row, .bottom-row {
      display: flex;
      justify-content: space-between;
      flex-wrap: wrap;
    }

    .top-row div, .bottom-row div {
      flex: 1 1 30%;
      margin: 5px 0;
    }

    @media (max-width: 600px) {
      input, button {
        font-size: 14px;
      }
    }
  </style>
</head>
<body>
  <div class="tabs">
    <button class="tab-button active" onclick="showTab('search')">차량 검색</button>
    <button class="tab-button" onclick="showTab('add')">차량 추가</button>
  </div>

  <div id="search" class="section active">
    <h1>차량 검색</h1>
    <input placeholder="차 번호" id="car_number">
    <input placeholder="차 종류" id="car_type">
    <input placeholder="차 색상" id="car_color">
    <input placeholder="차 주인" id="owner_name">
    <input placeholder="폰 번호" id="phone_number">
    <button onclick="searchCar()">검색</button>
  </div>

  <div id="add" class="section">
    <h1>차량 추가</h1> <!-- h2 → h1, 디자인 통일 -->
    <input placeholder="차 번호" id="add_car_number">
    <input placeholder="차 종류" id="add_car_type">
    <input placeholder="차 색상" id="add_car_color">
    <input placeholder="차 주인" id="add_owner_name">
    <input placeholder="폰 번호" id="add_phone_number">
    <button onclick="addCar()">추가</button>
  </div>

  <div id="result"></div>

  <script>
    function showTab(tabName) {
      document.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active'));
      const activeButton = Array.from(document.querySelectorAll('.tab-button'))
        .find(btn => btn.textContent.includes(tabName === 'search' ? '검색' : '추가'));
      activeButton.classList.add('active');

      document.querySelectorAll('.section').forEach(section => section.classList.remove('active'));
      document.getElementById(tabName).classList.add('active');
    }

    async function searchCar() {
      const params = new URLSearchParams({
        car_number: document.getElementById('car_number').value,
        car_type: document.getElementById('car_type').value,
        car_color: document.getElementById('car_color').value,
        owner_name: document.getElementById('owner_name').value,
        phone_number: document.getElementById('phone_number').value,
      });

      const res = await fetch(`/search?${params}`);
      const data = await res.json();

      const resultDiv = document.getElementById('result');
      resultDiv.innerHTML = '';

      if (Array.isArray(data)) {
        data.forEach(car => {
          const item = document.createElement('div');
          item.className = 'result-item';
          item.innerHTML = `
            <div class="top-row">
              <div><strong>차 종류:</strong> ${car.car_type}</div>
              <div><strong>차 색상:</strong> ${car.car_color}</div>
              <div><strong>차 번호:</strong> ${car.car_number}</div>
            </div>
            <div class="bottom-row">
              <div><strong>차 주인:</strong> ${car.owner_name}</div>
              <div><strong>폰 번호:</strong> ${car.phone_number}</div>
            </div>
          `;
          resultDiv.appendChild(item);
        });
      } else {
        resultDiv.textContent = '결과가 없습니다.';
      }
    }

    async function addCar() {
      const body = {
        car_number: document.getElementById('add_car_number').value,
        car_type: document.getElementById('add_car_type').value,
        car_color: document.getElementById('add_car_color').value,
        owner_name: document.getElementById('add_owner_name').value,
        phone_number: document.getElementById('add_phone_number').value,
      };

      const res = await fetch('/add', {
        method: 'POST',
        headers: {'Content-Type': 'application/json'},
        body: JSON.stringify(body)
      });

      const data = await res.json();
      if (data.message && data.message.includes('성공')) {
        alert('등록 성공했습니다');
      } else {
        alert(data.message || '등록 실패');
      }
    }
  </script>
</body>
</html>
